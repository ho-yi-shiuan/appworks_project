<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel=stylesheet type="text/css" href="./index.css">
<script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
</head>
<body>
<span style="font-family:Microsoft JhengHei;">
	<header>
	<div class = "mainheader">
		<a href="/index.html"><!--<div id = "logo"><img src="/images/logo.png" width=100%></div>--></a>

			<ul class="headlist">
				<li>介面1</li>
				<li>｜</li>
				<li>介面2</li>
				<li>｜</li>
				<li>介面3</li>
			</ul>


			<ul class="sidelist">
				<li><a href="/profile.html"><img src="/images/member.png"></a></li>
				<li><img src="/images/bell.png"></li>
			</ul>

	</div>
	<div id = "black"></div>
	</header>
	<div class="insert">
		註冊新帳戶<a href="signin.html">（登入）</a></br>
		姓名:</br><input type="text" id="name" value = "testname" style="font-size:15px"></input></br>
		信箱:</br><input type="text" id="email" value = "test@test.com" style="font-size:15px"></input></br>
		密碼:</br><input type="text" id="password" value = "testpassword" style="font-size:15px"></input></br>
		<button id="submit" style="button" onclick="signup();">註冊</button>
	</div>
	<div class="success">
		<div>註冊已成功, 資料如以下:</div></br>
		<div class="nameline">姓名:<div id="successname"></div></div></br>
		<div class="emailline">信箱:<div id="successemail"></div></div>
	</div>
	<div id="fail"></div>
</span>	
</body>
<script>
function signup(){
	var signup_data = {
		name: document.getElementById("name").value,
		email: document.getElementById("email").value,
		password: document.getElementById("password").value
	}
	$.ajax({
		contentType :"application/json",
		type: "POST",
		url: "/signup",
		data: JSON.stringify(signup_data),
		success: function(res)
		{
			console.log(res);
			if(res == "3")
			{
				console.log("user exist")
				document.getElementById("fail").innerHTML = "帳號已存在, 請至登入頁登入";
				document.getElementsByClassName("success")[0].style.display = "none";
				document.getElementById("fail").style.display = "block";				
			}
			else
			{
				console.log(res);
				console.log("success");
				document.getElementById("successname").innerHTML = res.data.user.name;
				document.getElementById("successemail").innerHTML = res.data.user.email;
				document.getElementsByClassName("success")[0].style.display = "block";
				document.getElementById("fail").style.display = "none";
			}
		},
		error: function(err)
		{
			console.log(err);
		},
		dataType: "json"
		});	
}

</script>